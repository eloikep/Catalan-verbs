<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RÃ©vision Catalan</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen p-4">
    <div id="app"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>
    <script>
const v=[{f:'Ãªtre',e:'ser',c:'ser',p:['soc','ets','Ã©s','som','sou','sÃ³n'],fu:['serÃ©','serÃ s','serÃ ','serem','sereu','seran'],s:['sigui','siguis','sigui','siguem','sigueu','siguin'],i:['era','eres','era','Ã©rem','Ã©reu','eren'],g:'essent'},
{f:'avoir',e:'tener',c:'tenir',p:['tinc','tens','tÃ©','tenim','teniu','tenen'],fu:['tindrÃ©','tindrÃ s','tindrÃ ','tindrem','tindreu','tindran'],s:['tingui','tinguis','tingui','tinguem','tingueu','tinguin'],i:['tenia','tenies','tenia','tenÃ­em','tenÃ­eu','tenien'],g:'tenint'},
{f:'aller',e:'ir',c:'anar',p:['vaig','vas','va','anem','aneu','van'],fu:['anirÃ©','anirÃ s','anirÃ ','anirem','anireu','aniran'],s:['vagi','vagis','vagi','anem','aneu','vagin'],i:['anava','anaves','anava','anÃ vem','anÃ veu','anaven'],g:'anant'},
{f:'faire',e:'hacer',c:'fer',p:['faig','fas','fa','fem','feu','fan'],fu:['farÃ©','farÃ s','farÃ ','farem','fareu','faran'],s:['faci','facis','faci','fem','feu','facin'],i:['feia','feies','feia','fÃ¨iem','fÃ¨ieu','feien'],g:'fent'},
{f:'pouvoir',e:'poder',c:'poder',p:['puc','pots','pot','podem','podeu','poden'],fu:['podrÃ©','podrÃ s','podrÃ ','podrem','podreu','podran'],s:['pugui','puguis','pugui','puguem','pugueu','puguin'],i:['podia','podies','podia','podÃ­em','podÃ­eu','podien'],g:'podent'},
{f:'vouloir',e:'querer',c:'voler',p:['vull','vols','vol','volem','voleu','volen'],fu:['voldrÃ©','voldrÃ s','voldrÃ ','voldrem','voldreu','voldran'],s:['vulgui','vulguis','vulgui','vulguem','vulgueu','vulguin'],i:['volia','volies','volia','volÃ­em','volÃ­eu','volien'],g:'volent'},
{f:'dire',e:'decir',c:'dir',p:['dic','dius','diu','diem','dieu','diuen'],fu:['dirÃ©','dirÃ s','dirÃ ','direm','direu','diran'],s:['digui','diguis','digui','diguem','digueu','diguin'],i:['deia','deies','deia','dÃ¨iem','dÃ¨ieu','deien'],g:'dient'},
{f:'venir',e:'venir',c:'venir',p:['vinc','vÃ©ns','vÃ©','venim','veniu','vÃ©nen'],fu:['vindrÃ©','vindrÃ s','vindrÃ ','vindrem','vindreu','vindran'],s:['vingui','vinguis','vingui','vinguem','vingueu','vinguin'],i:['venia','venies','venia','venÃ­em','venÃ­eu','venien'],g:'venint'},
{f:'savoir',e:'saber',c:'saber',p:['sÃ©','saps','sap','sabem','sabeu','saben'],fu:['sabrÃ©','sabrÃ s','sabrÃ ','sabrem','sabreu','sabran'],s:['sÃ piga','sÃ pigues','sÃ piga','sapiguem','sapigueu','sÃ piguen'],i:['sabia','sabies','sabia','sabÃ­em','sabÃ­eu','sabien'],g:'sabent'},
{f:'voir',e:'ver',c:'veure',p:['veig','veus','veu','veiem','veieu','veuen'],fu:['veurÃ©','veurÃ s','veurÃ ','veurem','veureu','veuran'],s:['vegi','vegis','vegi','vegem','vegeu','vegin'],i:['veia','veies','veia','vÃ¨iem','vÃ¨ieu','veien'],g:'veient'},
{f:'donner',e:'dar',c:'donar',p:['dono','dones','dona','donem','doneu','donen'],fu:['donarÃ©','donarÃ s','donarÃ ','donarem','donareu','donaran'],s:['doni','donis','doni','donem','doneu','donin'],i:['donava','donaves','donava','donÃ vem','donÃ veu','donaven'],g:'donant'},
{f:'prendre',e:'tomar',c:'prendre',p:['prenc','prens','pren','prenem','preneu','prenen'],fu:['prendrÃ©','prendrÃ s','prendrÃ ','prendrem','prendreu','prendran'],s:['prengui','prenguis','prengui','prenguem','prengueu','prenguin'],i:['prenia','prenies','prenia','prenÃ­em','prenÃ­eu','prenien'],g:'prenent'},
{f:'parler',e:'hablar',c:'parlar',p:['parlo','parles','parla','parlem','parleu','parlen'],fu:['parlarÃ©','parlarÃ s','parlarÃ ','parlarem','parlareu','parlaran'],s:['parli','parlis','parli','parlem','parleu','parlin'],i:['parlava','parlaves','parlava','parlÃ vem','parlÃ veu','parlaven'],g:'parlant'},
{f:'sortir',e:'salir',c:'sortir',p:['surto','surts','surt','sortim','sortiu','surten'],fu:['sortirÃ©','sortirÃ s','sortirÃ ','sortirem','sortireu','sortiran'],s:['surti','surtis','surti','sortim','sortiu','surtin'],i:['sortia','sorties','sortia','sortÃ­em','sortÃ­eu','sortien'],g:'sortint'},
{f:'mettre',e:'poner',c:'posar',p:['poso','poses','posa','posem','poseu','posen'],fu:['posarÃ©','posarÃ s','posarÃ ','posarem','posareu','posaran'],s:['posi','posis','posi','posem','poseu','posin'],i:['posava','posaves','posava','posÃ vem','posÃ veu','posaven'],g:'posant'},
{f:'vivre',e:'vivir',c:'viure',p:['visc','vius','viu','vivim','viviu','viuen'],fu:['viurÃ©','viurÃ s','viurÃ ','viurem','viureu','viuran'],s:['visqui','visquis','visqui','visquem','visqueu','visquin'],i:['vivia','vivies','vivia','vivÃ­em','vivÃ­eu','vivien'],g:'vivint'},
{f:'Ã©crire',e:'escribir',c:'escriure',p:['escric','escrius','escriu','escrivim','escriviu','escriuen'],fu:['escriurÃ©','escriurÃ s','escriurÃ ','escriurem','escriureu','escriuran'],s:['escrigui','escriguis','escrigui','escriguem','escrigueu','escriguin'],i:['escrivia','escrivies','escrivia','escrivÃ­em','escrivÃ­eu','escrivien'],g:'escrivint'},
{f:'boire',e:'beber',c:'beure',p:['bec','beus','beu','bevem','beveu','beuen'],fu:['beurÃ©','beurÃ s','beurÃ ','beurem','beureu','beuran'],s:['begui','beguis','begui','beguem','begueu','beguin'],i:['bevia','bevies','bevia','bevÃ­em','bevÃ­eu','bevien'],g:'bevent'},
{f:'connaÃ®tre',e:'conocer',c:'conÃ¨ixer',p:['conec','coneixes','coneix','coneixem','coneixeu','coneixen'],fu:['coneixerÃ©','coneixerÃ s','coneixerÃ ','coneixerem','coneixereu','coneixeran'],s:['conegui','coneguis','conegui','coneguem','conegueu','coneguin'],i:['coneixia','coneixies','coneixia','coneixÃ­em','coneixÃ­eu','coneixien'],g:'coneixent'},
{f:'courir',e:'correr',c:'cÃ³rrer',p:['corro','corres','corre','correm','correu','corren'],fu:['correrÃ©','correrÃ s','correrÃ ','correrem','correreu','correran'],s:['corri','corris','corri','correm','correu','corrin'],i:['corria','corries','corria','corrÃ­em','corrÃ­eu','corrien'],g:'corrent'},
{f:'perdre',e:'perder',c:'perdre',p:['perdo','perds','perd','perdem','perdeu','perden'],fu:['perdrÃ©','perdrÃ s','perdrÃ ','perdrem','perdreu','perdran'],s:['perdi','perdis','perdi','perdem','perdeu','perdin'],i:['perdia','perdies','perdia','perdÃ­em','perdÃ­eu','perdien'],g:'perdent'},
{f:'servir',e:'servir',c:'servir',p:['serveixo','serveixes','serveix','servim','serviu','serveixen'],fu:['servirÃ©','servirÃ s','servirÃ ','servirem','servireu','serviran'],s:['serveixi','serveixis','serveixi','servim','serviu','serveixin'],i:['servia','servies','servia','servÃ­em','servÃ­eu','servien'],g:'servint'},
{f:'lire',e:'leer',c:'llegir',p:['llegeixo','llegeixes','llegeix','llegim','llegiu','llegeixen'],fu:['llegirÃ©','llegirÃ s','llegirÃ ','llegirem','llegireu','llegiran'],s:['llegeixi','llegeixis','llegeixi','llegim','llegiu','llegeixin'],i:['llegia','llegies','llegia','llegÃ­em','llegÃ­eu','llegien'],g:'llegint'},
{f:'travailler',e:'trabajar',c:'treballar',p:['treballo','treballes','treballa','treballem','treballeu','treballen'],fu:['treballarÃ©','treballarÃ s','treballarÃ ','treballarem','treballareu','treballaran'],s:['treballi','treballis','treballi','treballem','treballeu','treballin'],i:['treballava','treballaves','treballava','treballÃ vem','treballÃ veu','treballaven'],g:'treballant'},
{f:'manger',e:'comer',c:'menjar',p:['menjo','menges','menja','mengem','mengeu','mengen'],fu:['menjarÃ©','menjarÃ s','menjarÃ ','menjarem','menjareu','menjaran'],s:['mengi','mengis','mengi','mengem','mengeu','mengin'],i:['menjava','menjaves','menjava','menjÃ vem','menjÃ veu','menjaven'],g:'menjant'}];

const pr=[{c:'jo',f:'je',e:'yo',i:0},{c:'tu',f:'tu',e:'tÃº',i:1},{c:'ell/ella',f:'il/elle',e:'Ã©l/ella',i:2},{c:'nosaltres',f:'nous',e:'nosotros/as',i:3},{c:'vosaltres',f:'vous',e:'vosotros/as',i:4},{c:'ells/elles',f:'ils/elles',e:'ellos/ellas',i:5}];

const pAux=['vaig','vas','va','vam','vau','van'];

const t={fr:{title:'RÃ©vision Catalan',menu:{title:'Menu Principal',verbs:'Verbes',selectTenses:'SÃ©lectionner les temps',start:'Commencer',vocab:'Vocabulaire',soon:'(BientÃ´t)',changeLang:'Changer de langue'},tenses:{present:'PrÃ©sent',future:'Futur',subj:'Subjonctif',imp:'Imparfait',gerund:'GÃ©rondif',periph:'PassÃ© pÃ©riphrastique'},game:{back:'â† Menu',step1:'Ã‰tape 1: Traduction',step2:'Ã‰tape 2: Conjugaison',verb:'Verbe',q1:'Quelle est la traduction en catalan ?',q2:'au',full:'Conjugaison complÃ¨te de',next:'Question suivante',ok:'OK, continuer',gerundQ:'Estic _____ (',periphQ:' _____ '}},es:{title:'Repaso CatalÃ¡n',menu:{title:'MenÃº Principal',verbs:'Verbos',selectTenses:'Seleccionar tiempos',start:'Comenzar',vocab:'Vocabulario',soon:'(PrÃ³ximamente)',changeLang:'Cambiar idioma'},tenses:{present:'Presente',future:'Futuro',subj:'Subjuntivo',imp:'Imperfecto',gerund:'Gerundio',periph:'Pasado perifrÃ¡stico'},game:{back:'â† MenÃº',step1:'Paso 1: TraducciÃ³n',step2:'Paso 2: ConjugaciÃ³n',verb:'Verbo',q1:'Â¿CuÃ¡l es la traducciÃ³n al catalÃ¡n?',q2:'en',full:'ConjugaciÃ³n completa de',next:'Siguiente pregunta',ok:'OK, continuar',gerundQ:'Estic _____ (',periphQ:' _____ '}}};

let st={screen:'language',lang:null,stage:'translation',verb:null,pron:null,opts:[],sel:null,show:false,score:0,total:0,qCount:0,tenses:{present:true,future:false,subj:false,imp:false,gerund:false,periph:false},tense:null};

function genTrOpts(verb){const d=v.filter(x=>x.c!==verb.c).sort(()=>Math.random()-0.5).slice(0,3).map(x=>x.c);return[verb.c,...d].sort(()=>Math.random()-0.5);}

function createTrap(correct,allForms){const traps=[];if(correct.includes('eix')){traps.push(correct.replace('eix','ix'),correct.replace('eix','ieix'));}
if(correct.includes('iu')){traps.push(correct.replace('iu','ieu'),correct.replace('iu','iueu'));}
if(correct.includes('visc')){traps.push('visco','viscu');}
if(correct.endsWith('c')){traps.push(correct+'o');}
if(correct.includes('prenc')){traps.push('prend','preno');}
return traps.filter(x=>!allForms.includes(x));}

function genConjOpts(verb,idx,tense){let correct,allForms;if(tense==='gerund'){correct=verb.g;allForms=[correct];const traps=createTrap(correct,allForms);return[correct,...traps.slice(0,3)].sort(()=>Math.random()-0.5);}
if(tense==='periph'){correct=pAux[idx];const traps=['vais','vaijo','vago','vais a','vam a'];return[correct,..._.shuffle(traps).slice(0,3)].sort(()=>Math.random()-0.5);}
const tMap={present:'p',future:'fu',subj:'s',imp:'i'};correct=verb[tMap[tense]][idx];allForms=verb[tMap[tense]];const opts=[correct];const otherConjs=allForms.filter((_,i)=>i!==idx);const traps=createTrap(correct,allForms);const pool=[...otherConjs,...traps];return[correct,..._.shuffle(pool).slice(0,3)].sort(()=>Math.random()-0.5);}

function startQ(){const activeTenses=Object.keys(st.tenses).filter(k=>st.tenses[k]);const tense=activeTenses[Math.floor(Math.random()*activeTenses.length)];const verb=v[Math.floor(Math.random()*v.length)];const pron=pr[Math.floor(Math.random()*pr.length)];st={...st,verb,pron,stage:'translation',opts:genTrOpts(verb),sel:null,show:false,tense};}

function handleAns(ans){st.sel=ans;st.show=true;if(st.stage==='translation'){const ok=ans===st.verb.c;if(!ok)st.total++;render();if(ok){st.stage='conjugation';st.opts=genConjOpts(st.verb,st.pron.i,st.tense);st.sel=null;st.show=false;render();}}else{let correct;if(st.tense==='gerund')correct=st.verb.g;else if(st.tense==='periph')correct=pAux[st.pron.i];else{const tMap={present:'p',future:'fu',subj:'s',imp:'i'};correct=st.verb[tMap[st.tense]][st.pron.i];}
if(ans===correct)st.score++;st.total++;st.qCount++;render();}}

function next(){if(st.qCount>0&&st.qCount%10===0){st.screen='stats';render();}else{startQ();}}

function renderLang(){return`<div class="max-w-md mx-auto mt-20"><div class="bg-white rounded-lg shadow-xl p-8 text-center"><h1 class="text-4xl font-bold text-indigo-900 mb-8">ğŸ‡ªğŸ‡¸ CatalÃ  ğŸ‡«ğŸ‡·</h1><p class="text-gray-600 mb-8">Choisissez votre langue / Elige tu idioma</p><div class="space-y-4"><button onclick="st.lang='fr';st.screen='menu';render()" class="w-full bg-indigo-600 text-white py-4 rounded-lg font-bold text-xl hover:bg-indigo-700">ğŸ‡«ğŸ‡· FranÃ§ais</button><button onclick="st.lang='es';st.screen='menu';render()" class="w-full bg-red-600 text-white py-4 rounded-lg font-bold text-xl hover:bg-red-700">ğŸ‡ªğŸ‡¸ EspaÃ±ol</button></div></div></div>`;}

function renderMenu(){const tx=t[st.lang].menu;const tt=t[st.lang].tenses;const hasSelected=Object.values(st.tenses).some(x=>x);return`<div class="max-w-md mx-auto mt-10"><div class="bg-white rounded-lg shadow-xl p-8"><h1 class="text-3xl font-bold text-indigo-900 mb-6 text-center">${tx.title}</h1><div class="bg-blue-50 p-4 rounded-lg mb-6"><h2 class="font-bold text-blue-900 mb-3">${tx.selectTenses}</h2><div class="space-y-2">${Object.keys(st.tenses).map(k=>`<label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" ${st.tenses[k]?'checked':''} onchange="st.tenses.${k}=this.checked;render()" class="w-4 h-4"><span>${tt[k]}</span></label>`).join('')}</div></div><button onclick="if(${hasSelected}){st.screen='verbs';st.score=0;st.total=0;st.qCount=0;startQ();}else{alert('SÃ©lectionnez au moins un temps')}" class="w-full bg-indigo-600 text-white py-4 rounded-lg font-bold text-xl hover:bg-indigo-700 mb-4">${tx.start}</button><button disabled class="w-full bg-gray-300 text-gray-500 py-4 rounded-lg font-bold mb-4 cursor-not-allowed">${tx.vocab} ${tx.soon}</button><button onclick="st={...st,screen:'language',lang:null}" class="w-full bg-gray-200 text-gray-700 py-2 rounded-lg hover:bg-gray-300">ğŸŒ ${tx.changeLang}</button></div></div>`;}

function renderGame(){if(!st.verb||!st.pron)return'';const tx=t[st.lang].game;const tt=t[st.lang].tenses;const isCorrect=st.stage==='translation'?st.sel===st.verb.c:st.sel===(st.tense==='gerund'?st.verb.g:st.tense==='periph'?pAux[st.pron.i]:st.verb[{present:'p',future:'fu',subj:'s',imp:'i'}[st.tense]][st.pron.i]);const correctAns=st.stage==='translation'?st.verb.c:st.tense==='gerund'?st.verb.g:st.tense==='periph'?pAux[st.pron.i]:st.verb[{present:'p',future:'fu',subj:'s',imp:'i'}[st.tense]][st.pron.i];let q2='';if(st.stage==='conjugation'){if(st.tense==='gerund')q2=tx.gerundQ+st.verb.c+')';else if(st.tense==='periph')q2=`${st.pron.c}${tx.periphQ}${st.verb.c}`;else q2=`${st.pron.c} _____ (${st.verb.c}) ${tx.q2} ${tt[st.tense]}`;}
return`<div class="max-w-2xl mx-auto"><div class="bg-white rounded-lg shadow-xl p-8"><div class="flex justify-between items-center mb-6"><button onclick="st.screen='menu';render()" class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300">${tx.back}</button><div class="flex gap-2"><div class="bg-purple-100 px-3 py-2 rounded-lg text-sm font-medium">${st.qCount}</div><div class="bg-indigo-100 px-3 py-2 rounded-lg font-bold">ğŸ† ${st.score}/${st.total}</div></div></div><div class="mb-6"><div class="flex gap-2 mb-4"><div class="flex-1 h-2 rounded ${st.stage==='translation'?'bg-indigo-500':'bg-green-500'}"></div><div class="flex-1 h-2 rounded ${st.stage==='conjugation'?'bg-indigo-500':'bg-gray-300'}"></div></div><p class="text-sm text-gray-600">${st.stage==='translation'?tx.step1:tx.step2}</p></div>${st.stage==='translation'?`<div class="mb-6"><h2 class="text-2xl font-bold text-center mb-4">${tx.verb}: <span class="text-indigo-600">${st.verb[st.lang]}</span></h2><p class="text-gray-600 text-center">${tx.q1}</p></div>`:`<div class="mb-6"><h2 class="text-2xl font-bold text-center mb-4 text-indigo-600">${q2}</h2></div>`}<div class="space-y-3">${st.opts.map(o=>`<button onclick="handleAns('${o.replace(/'/g,"\\'")}')" ${st.show?'disabled':''} class="w-full p-4 rounded-lg text-lg font-medium transition ${st.show?o===correctAns?'bg-green-500 text-white':o===st.sel?'bg-red-500 text-white':'bg-gray-100 text-gray-400':'bg-indigo-50 text-indigo-900 hover:bg-indigo-100'}"><div class="flex justify-between items-center"><span>${o}</span>${st.show&&o===correctAns?'<span class="text-2xl">âœ“</span>':st.show&&o===st.sel&&o!==correctAns?'<span class="text-2xl">âœ—</span>':''}</div></button>`).join('')}</div>${st.show&&st.stage==='conjugation'&&!isCorrect?`<div class="mt-4 bg-blue-50 p-4 rounded-lg"><h3 class="font-bold text-blue-900 mb-2">${tx.full} "${st.verb.c}" ${tx.q2} ${tt[st.tense]}:</h3><div class="grid grid-cols-2 gap-2 text-sm">${pr.map((p,i)=>`<div class="text-blue-800"><span class="font-medium">${p.c}:</span> ${st.verb[{present:'p',future:'fu',subj:'s',imp:'i'}[st.tense]][i]}</div>`).join('')}</div></div>`:''}${st.show?`<button onclick="next()" class="w-full mt-4 bg-indigo-600 text-white py-3 rounded-lg font-bold hover:bg-indigo-700">${st.stage==='conjugation'||!isCorrect?tx.next:tx.ok}</button>`:''}</div></div>`;}

function render(){const screens={language:renderLang,menu:renderMenu,verbs:renderGame};document.getElementById('app').innerHTML=screens[st.screen]();}

render();
    </script>
</body>
</html>
